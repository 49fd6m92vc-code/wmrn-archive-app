<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <title>Photos â€“ WMRN Archive</title>

  <link rel="stylesheet" href="/wmrn-archive-app/styles.css">
  <meta name="theme-color" content="#9b1c1c">

  <!-- GLOBAL APP LOGIC -->
  <script src="/wmrn-archive-app/app.js" defer></script>
</head>

<body>

<main class="photos-page">

  <h1>Photo Archive</h1>

  <p class="page-intro">
    This section preserves photographs documenting the people, studios,
    equipment, events, and everyday life of WMRN Radio.
    Many of the images shown here were contributed by former WMRN DJ
    Paul Van House.
  </p>

  <!-- JS FILLS THIS -->
  <section id="photoGrid" class="photo-grid"></section>

</main>

<!-- LIGHTBOX -->
<div id="lightbox" class="lightbox" aria-hidden="true">
  <button class="lightbox-close" aria-label="Close photo">&times;</button>
  <img id="lightboxImage" alt="">
  <p id="lightboxCaption" class="lightbox-caption"></p>
</div>

<!-- LOAD PHOTO LIST -->
<script src="/wmrn-archive-app/photos.js"></script>

<!-- RENDER + LIGHTBOX -->
<script>
  const grid = document.getElementById("photoGrid");
  const lightbox = document.getElementById("lightbox");
  const lightboxImage = document.getElementById("lightboxImage");
  const lightboxCaption = document.getElementById("lightboxCaption");
  const closeBtn = document.querySelector(".lightbox-close");

  photos.forEach(filename => {
    const card = document.createElement("div");
    card.className = "photo-card";

    const img = document.createElement("img");
    img.src = `/wmrn-archive-app/Photos/${filename}`;
    img.alt = filename.replace(/_/g, " ");

    img.addEventListener("click", () => {
      lightboxImage.src = img.src;
      lightboxImage.alt = img.alt;
      lightboxCaption.textContent = filename
        .replace(".jpg", "")
        .replace(/_/g, " ");
      lightbox.classList.add("open");
      lightbox.setAttribute("aria-hidden", "false");
    });

    const meta = document.createElement("p");
    meta.className = "photo-meta";
    meta.textContent = "Accession WMRN-2026-012";

    const caption = document.createElement("p");
    caption.className = "photo-caption";
    caption.textContent = filename
      .replace(".jpg", "")
      .replace(/_/g, " ");

    card.appendChild(img);
    card.appendChild(meta);
    card.appendChild(caption);
    grid.appendChild(card);
  });

  function closeLightbox() {
    lightbox.classList.remove("open");
    lightbox.setAttribute("aria-hidden", "true");
    lightboxImage.src = "";
  }

  closeBtn.addEventListener("click", closeLightbox);

  lightbox.addEventListener("click", e => {
    if (e.target === lightbox) closeLightbox();
  });
</script>

<!-- FLOATING BOTTOM NAV -->
<nav class="bottom-nav" id="bottomNav" aria-label="Primary navigation">
  <a href="/wmrn-archive-app/index.html">
    <span class="icon">ğŸ </span>
    <span>Home</span>
  </a>
  <a href="/wmrn-archive-app/decades.html">
    <span class="icon">ğŸ“†</span>
    <span>Decades</span>
  </a>
  <a href="/wmrn-archive-app/photos.html">
    <span class="icon">ğŸ“·</span>
    <span>Photos</span>
  </a>
  <a href="/wmrn-archive-app/audio.html">
    <span class="icon">ğŸ™ï¸</span>
    <span>Audio</span>
  </a>
  <a href="/wmrn-archive-app/submit.html">
    <span class="icon">âœï¸</span>
    <span>Submit</span>
  </a>
  <a href="/wmrn-archive-app/settings.html">
    <span class="icon">âš™ï¸</span>
    <span>Settings</span>
  </a>
</nav>

<!-- NAV BEHAVIOR -->
<script>
  const navLinks = document.querySelectorAll(".bottom-nav a");
  const currentPath = window.location.pathname;

  navLinks.forEach(link => {
    if (currentPath.includes(link.getAttribute("href"))) {
      link.classList.add("active");
    }
  });

  function hapticTap() {
    if (navigator.vibrate && localStorage.getItem("haptics") !== "off") {
      navigator.vibrate(10);
    }
  }

  navLinks.forEach(link => {
    link.addEventListener("click", hapticTap);
  });

  const pages = [
    "/wmrn-archive-app/index.html",
    "/wmrn-archive-app/decades.html",
    "/wmrn-archive-app/photos.html",
    "/wmrn-archive-app/audio.html",
    "/wmrn-archive-app/submit.html",
    "/wmrn-archive-app/settings.html"
  ];

  let startX = 0;
  let startY = 0;
  let isSwiping = false;

  window.addEventListener("touchstart", e => {
    if (localStorage.getItem("swipeNav") === "off") return;
    const touch = e.touches[0];
    startX = touch.clientX;
    startY = touch.clientY;
    isSwiping = true;
  }, { passive: true });

  window.addEventListener("touchmove", e => {
    if (!isSwiping) return;
    const touch = e.touches[0];
    if (Math.abs(touch.clientY - startY) > Math.abs(touch.clientX - startX)) {
      isSwiping = false;
    }
  }, { passive: true });

  window.addEventListener("touchend", e => {
    if (!isSwiping) return;
    const diffX = e.changedTouches[0].clientX - startX;
    if (Math.abs(diffX) < 90) return;

    const index = pages.findIndex(p => currentPath.includes(p));
    if (diffX < 0 && index < pages.length - 1) location.href = pages[index + 1];
    if (diffX > 0 && index > 0) location.href = pages[index - 1];
  }, { passive: true });
</script>

</body>
</html>
