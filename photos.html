<script>
const grid = document.getElementById("photoGrid");

if (!grid) {
  console.error("photoGrid not found");
}

// âœ… CORRECT VALUES
const GITHUB_USER = "49fd6m92vc-code";
const REPO_NAME = "wmrn-archive-app";
const PHOTOS_PATH = "Photos";

fetch(`https://api.github.com/repos/${GITHUB_USER}/${REPO_NAME}/contents/${PHOTOS_PATH}`)
  .then(res => {
    if (!res.ok) {
      throw new Error("GitHub API error: " + res.status);
    }
    return res.json();
  })
  .then(files => {
    files
      .filter(file =>
        file.type === "file" &&
        /\.(jpg|jpeg|png)$/i.test(file.name)
      )
      .forEach(file => {
        const filename = file.name;
        const readable = filename
          .replace(/\.[^.]+$/, "")
          .replace(/_/g, " ");

        const link = document.createElement("a");
        link.href = `/wmrn-archive-app/item.html?file=${encodeURIComponent(filename)}`;
        link.className = "photo-card";

        const img = document.createElement("img");
        img.src = file.download_url;
        img.alt = readable;
        img.loading = "lazy";

        const meta = document.createElement("p");
        meta.className = "photo-meta";
        meta.textContent = "WMRN Radio History Archive";

        const caption = document.createElement("p");
        caption.className = "photo-caption";
        caption.textContent = readable;

        link.appendChild(img);
        link.appendChild(meta);
        link.appendChild(caption);
        grid.appendChild(link);
      });
  })
  .catch(err => {
    console.error(err);
    grid.innerHTML = "<p class='muted'>Unable to load photos.</p>";
  });
</script>