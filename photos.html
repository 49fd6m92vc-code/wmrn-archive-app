<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Photos â€“ WMRN Archive</title>

  <link rel="stylesheet" href="/wmrn-archive-app/styles.css">
  <meta name="theme-color" content="#9b1c1c">
</head>

<body>

<main class="photos-page">
  <h1>Photo Archive</h1>

  <p class="page-intro">
    This section preserves photographs documenting the people, studios,
    equipment, and daily life of WMRN Radio.
  </p>

  <section id="photoGrid" class="photo-grid">
    <p class="muted">Loading photosâ€¦</p>
  </section>
</main>

<!-- âœ… SCRIPT MUST BE LAST THING IN BODY -->
<script>
(function () {
  const grid = document.getElementById("photoGrid");

  if (!grid) {
    document.body.innerHTML = "<p style='color:white'>photoGrid missing</p>";
    return;
  }

  const OWNER = "49fd6m92vc-code";
  const REPO = "wmrn-archive-app";
  const PATH = "Photos";

  const apiURL = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${PATH}`;

  fetch(apiURL)
    .then(res => {
      if (!res.ok) throw new Error("GitHub API failed");
      return res.json();
    })
    .then(files => {
      grid.innerHTML = "";

      const images = files.filter(f =>
        f.type === "file" && /\.(jpg|jpeg|png)$/i.test(f.name)
      );

      if (!images.length) {
        grid.innerHTML = "<p class='muted'>No images found.</p>";
        return;
      }

      images.forEach(file => {
        const card = document.createElement("a");
        card.href = `/wmrn-archive-app/item.html?file=${encodeURIComponent(file.name)}`;
        card.className = "photo-card";

        const img = document.createElement("img");
        img.src = file.download_url;
        img.alt = file.name;
        img.loading = "lazy";

        const caption = document.createElement("p");
        caption.className = "photo-caption";
        caption.textContent = file.name.replace(/\.(jpg|png)$/i, "").replace(/_/g, " ");

        card.appendChild(img);
        card.appendChild(caption);
        grid.appendChild(card);
      });
    })
    .catch(err => {
      console.error(err);
      grid.innerHTML = "<p class='muted'>Failed to load photos.</p>";
    });
})();
</script>

<nav class="bottom-nav">
  <a href="/wmrn-archive-app/index.html">ğŸ  Home</a>
  <a href="/wmrn-archive-app/decades.html">ğŸ“† Decades</a>
  <a href="/wmrn-archive-app/photos.html">ğŸ“· Photos</a>
  <a href="/wmrn-archive-app/audio.html">ğŸ™ï¸ Audio</a>
  <a href="/wmrn-archive-app/submit.html">âœï¸ Submit</a>
  <a href="/wmrn-archive-app/settings.html">âš™ï¸ Settings</a>
</nav>

</body>
</html>

</body>
</html>